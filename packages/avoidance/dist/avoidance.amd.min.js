define("Avoidance",[],(function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}n.r(e),n.d(e,"default",(function(){return c}));var c=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];o(this,t);var a=document.querySelectorAll(e);this.containers=Array.prototype.slice.call(a),this.options=this.initOptions(n),this.trackedParticles=[],this.trackedParticleElementsSet=new Set,this.mouseMoveHandler=this.mouseMoveHandler.bind(this),this.clickHandler=this.clickHandler.bind(this),this.touchStartHandler=this.touchStartHandler.bind(this),this.touchEndHandler=this.touchEndHandler.bind(this),i&&this.containers.forEach((function(t){for(var e=0;e<t.children.length;++e)this.startTrackingParticleElement(t.children[e],t)}),this),this.status="ready"}return r(t,[{key:"initOptions",value:function(e){var n={factorMethod:{}};return"factorMethod"in e&&("string"==typeof e.factorMethod&&e.factorMethod in t.calculateAvoidanceFactor.builtinMethods?(n.factorMethod.name=e.factorMethod,n.factorMethod.scale=void 0,n.factorMethod.offset=void 0,n.factorMethod.power=void 0):"object"===i(e.factorMethod)?("name"in e.factorMethod&&"string"==typeof e.factorMethod.name&&e.factorMethod.name in t.calculateAvoidanceFactor.builtinMethods?n.factorMethod.name=e.factorMethod.name:n.factorMethod.name=void 0,"scale"in e.factorMethod&&"number"==typeof e.factorMethod.scale?n.factorMethod.scale=e.factorMethod.scale:n.factorMethod.scale=void 0,"offset"in e.factorMethod&&"number"==typeof e.factorMethod.offset?n.factorMethod.offset=e.factorMethod.offset:n.factorMethod.offset=void 0,"power"in e.factorMethod&&"number"==typeof e.factorMethod.power?n.factorMethod.power=e.factorMethod.power:n.factorMethod.power=void 0):(n.factorMethod.name=void 0,n.factorMethod.scale=void 0,n.factorMethod.offset=void 0,n.factorMethod.power=void 0)),n.displacementMethod={},"displacementMethod"in e&&("string"==typeof e.displacementMethod&&e.displacementMethod in t.calculateAvoidanceDisplacement.builtinMethods?(n.displacementMethod.name=e.displacementMethod,n.displacementMethod.thresholdRadius=void 0):"object"===i(e.displacementMethod)?("name"in e.displacementMethod&&"string"==typeof e.displacementMethod.name&&e.displacementMethod.name in t.calculateAvoidanceDisplacement.builtinMethods?n.displacementMethod.name=e.displacementMethod.name:n.displacementMethod.name=void 0,"thresholdRadius"in e.displacementMethod&&"number"==typeof e.displacementMethod.thresholdRadius?n.displacementMethod.thresholdRadius=e.displacementMethod.thresholdRadius:n.displacementMethod.thresholdRadius=void 0):(n.displacementMethod.name=void 0,n.displacementMethod.thresholdRadius=void 0)),"timing"in e&&"string"==typeof e.timing&&e.timing in t.animate.timings?n.timing=t.animate.timings[e.timing]:n.timing=t.animate.timings.easeOutExpo,"pathing"in e&&"string"==typeof e.pathing&&e.pathing in t.animate.paths?n.pathing=e.pathing:n.pathing="bezierQuad",n}},{key:"addParticles",value:function(t,e){var n=this;document.querySelectorAll(t).forEach((function(t){n.startTrackingParticleElement(t,e?document.querySelector(e):void 0)}),this)}},{key:"addParticleElement",value:function(t,e){this.startTrackingParticleElement(t,e)}},{key:"removeParticles",value:function(t){this.stopTrackingParticleElements(document.querySelectorAll(t))}},{key:"removeParticleElement",value:function(t){this.stopTrackingParticleElement(t)}},{key:"startTrackingParticleElement",value:function(e,n){if(!this.trackedParticleElementsSet.has(e)){n||(n=document.body);var i=new t.Particle(e,n);this.trackedParticles.push(i),this.trackedParticleElementsSet.add(e)}}},{key:"stopTrackingParticleElement",value:function(t){if(this.trackedParticleElementsSet.has(t)){this.trackedParticleElementsSet.delete(t);var e=this.trackedParticles.findIndex((function(e){return e.element===t}));-1!==e&&(this.trackedParticles[e].dispose(),this.trackedParticles.splice(e,1))}}},{key:"stopTrackingParticleElements",value:function(t){for(var e=new Set(t),n=0;n<this.trackedParticles.length;++n)e.has(this.trackedParticles[n].element)&&(this.trackedParticleElementsSet.delete(this.trackedParticles[n].element),this.trackedParticles[n].dispose(),this.trackedParticles[n]="removed");this.trackedParticles=this.trackedParticles.filter((function(t){return"removed"!==t}))}},{key:"start",value:function(){this.containers.forEach(this.registerEventHandlers,this),this.status="running"}},{key:"stop",value:function(){this.containers.forEach(this.deregisterEventHandlers,this),this.status="stopped"}},{key:"addContainers",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=document.querySelectorAll(t);n.forEach((function(t){if(!(this.containers.indexOf(t)>=0)){if(this.containers.push(t),e)for(var n=0;n<t.children.length;++n)this.startTrackingParticleElement(t.children[n]);"running"===this.status&&this.registerEventHandlers(t)}}),this)}},{key:"removeContainers",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=document.querySelectorAll(t);n.forEach((function(t){var n=this.containers.indexOf(t);n<0||(e&&this.stopTrackingParticleElements(t.children),"running"===this.status&&this.deregisterEventHandlers(t),this.containers.splice(n,1))}),this)}},{key:"registerEventHandlers",value:function(t){t.addEventListener("touchend",this.touchEndHandler),t.addEventListener("touchstart",this.touchStartHandler),t.addEventListener("mousemove",this.mouseMoveHandler),t.addEventListener("click",this.clickHandler)}},{key:"deregisterEventHandlers",value:function(t){t.removeEventListener("click",this.clickHandler),t.removeEventListener("mousemove",this.mouseMoveHandler),t.removeEventListener("touchstart",this.touchStartHandler),t.removeEventListener("touchend",this.touchEndHandler)}},{key:"mouseMoveHandler",value:function(t){if(this.touchStarted||this.touchEnded)t.preventDefault();else{var e=t.currentTarget,n={x:t.pageX-e.offsetLeft,y:t.pageY-e.offsetTop};this.computeAvoidance(e,n,this.renderImmediateAvoidance.bind(this))}}},{key:"clickHandler",value:function(t){if(this.touchStarted||this.touchEnded){var e=t.currentTarget,n={x:t.pageX-e.offsetLeft,y:t.pageY-e.offsetTop};this.computeAvoidance(e,n,this.renderAnimatedAvoidance.bind(this)),this.touchStarted=!1,this.touchEnded=!1}}},{key:"touchStartHandler",value:function(t){this.touchStarted=!0}},{key:"touchEndHandler",value:function(t){this.touchEnded=!0}},{key:"computeAvoidance",value:function(e,n,i){var o=e.getBoundingClientRect(),a=n.x/o.width,r=n.y/o.height;this.trackedParticles.forEach((function(e){var n=e.getSizeRatio(),o={x:e.originalPosRatio.x+1*n.width/2-a,y:e.originalPosRatio.y+1*n.height/2-r},c=t.geometry.getRadius(o),s=this.calculateAvoidanceFactor(c,n),l=this.calculateAvoidanceDisplacement(t.geometry.getUnitVector(o),s);i(l,e)}),this)}},{key:"renderImmediateAvoidance",value:function(e,n){if(null===e)n.element.style.display="none";else{var i={x:n.originalPosRatio.x+e.x,y:n.originalPosRatio.y+e.y};"none"===n.element.style.display&&(n.element.style.display=""),n.element.style.left=t.math.toPctStr(i.x),n.element.style.top=t.math.toPctStr(i.y)}}},{key:"renderAnimatedAvoidance",value:function(e,n){if(null===e)n.element.style.display="none";else{var i=n.getPosRatio(),o={x:n.originalPosRatio.x+e.x,y:n.originalPosRatio.y+e.y};"none"===n.element.style.display&&(n.element.style.display="");var a="bezierQuad"===this.options.pathing?t.animate.paths.bezierQuad(i,n.originalPosRatio,o):t.animate.paths.linear(i,o);t.animate.move(n.element,a,1e3,this.options.timing)}}},{key:"calculateAvoidanceFactor",value:function(e,n,i){void 0===i&&(i=this.options.factorMethod.name);return(void 0!==i?t.calculateAvoidanceFactor.builtinMethods[i]:t.calculateAvoidanceFactor.builtinMethods.powerInverse)(this.options.factorMethod.scale,this.options.factorMethod.offset,this.options.factorMethod.power)(e,n)}},{key:"calculateAvoidanceDisplacement",value:function(e,n,i){void 0===i&&(i=this.options.displacementMethod.name);return(void 0!==i?t.calculateAvoidanceDisplacement.builtinMethods[i]:t.calculateAvoidanceDisplacement.builtinMethods.threshold)(this.options.displacementMethod.thresholdRadius)(e,n)}}]),t}();c.geometry={getDistance:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},getRadius:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},getUnitVector:function(t){var e=c.geometry.getRadius(t);return{x:t.x/e,y:t.y/e}}},c.calculateAvoidanceFactor={builtinMethods:{inverse:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.02,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n,i){return 0===n?NaN:1*t/n+e}},exponential:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n,i){return Math.exp(t-n)+e}},powerInverse:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.02,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6;return function(i,o){return 0===i?NaN:1*t/Math.pow(1*i,n)+e}}}},c.calculateAvoidanceDisplacement={builtinMethods:{threshold:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1;return function(e,n){if(NaN===n)return null;var i={x:e.x*n,y:e.y*n};return c.geometry.getRadius(i)>t?{x:e.x*t,y:e.y*t}:i}},noThreshold:function(){return function(t,e){return NaN===e?null:{x:t.x*e,y:t.y*e}}}}},c.math={toPctStr:function(t){return 100*t+"%"}},c.animate={FRAME_DURATION:10,timings:{linear:function(t){return function(e){return e/t}},easeOutCubic:function(t){return function(e){return 1+Math.pow(e/t-1,3)}},easeOutExpo:function(t){return function(e){return 1-Math.pow(2,-10*e/t)}}},paths:{linear:function(t,e){return function(n){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}},bezierQuad:function(t,e,n){return function(i){return{x:e.x+(1-i)*(1-i)*(t.x-e.x)+i*i*(n.x-e.x),y:e.y+(1-i)*(1-i)*(t.y-e.y)+i*i*(n.y-e.y)}}}},move:function(t,e,n,i){var o=this,a=0,r=0,s=i(n),l=setInterval((function(){a>=n&&clearInterval(l);var i=e(r);t.style.left=c.math.toPctStr(i.x),t.style.top=c.math.toPctStr(i.y),a+=o.FRAME_DURATION,r=s(a)}),this.FRAME_DURATION)}},c.Particle=function(){function t(e,n){o(this,t),this.element=e,this.container=n,this.originalPosRatio=this.getPosRatio()}return r(t,[{key:"getPosRatio",value:function(){var t=this.element.getBoundingClientRect(),e=this.container.getBoundingClientRect();return{x:(t.left-e.left)/e.width,y:(t.top-e.top)/e.height}}},{key:"getSizeRatio",value:function(){var t=this.element.getBoundingClientRect(),e=this.container.getBoundingClientRect();return{width:t.width/e.width,height:t.height/e.height}}},{key:"dispose",value:function(){}}]),t}()}]).default}));
//# sourceMappingURL=avoidance.amd.min.js.map