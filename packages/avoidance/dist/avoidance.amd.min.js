define("Avoidance",[],(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.r(t),n.d(t,"default",(function(){return c}));var c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];i(this,e);var r=document.querySelectorAll(t);this.containers=Array.prototype.slice.call(r),this.options=this.initOptions(n),this.trackedParticles=[],this.trackedParticleElementsSet=new Set,this.mouseMoveHandler=this.mouseMoveHandler.bind(this),this.mouseClickTestHandler=this.mouseClickTestHandler.bind(this),o&&this.containers.forEach((function(e){for(var t=0;t<e.children.length;++t)this.startTrackingParticleElement(e.children[t])}),this),this.status="ready"}return a(e,[{key:"initOptions",value:function(t){var n={factorMethod:{}};return"factorMethod"in t&&("string"==typeof t.factorMethod&&t.factorMethod in e.calculateAvoidanceFactor.builtinMethods?(n.factorMethod.name=t.factorMethod,n.factorMethod.scale=void 0,n.factorMethod.offset=void 0,n.factorMethod.power=void 0):"object"===o(t.factorMethod)?("name"in t.factorMethod&&"string"==typeof t.factorMethod.name&&t.factorMethod.name in e.calculateAvoidanceFactor.builtinMethods?n.factorMethod.name=t.factorMethod.name:n.factorMethod.name=void 0,"scale"in t.factorMethod&&"number"==typeof t.factorMethod.scale?n.factorMethod.scale=t.factorMethod.scale:n.factorMethod.scale=void 0,"offset"in t.factorMethod&&"number"==typeof t.factorMethod.offset?n.factorMethod.offset=t.factorMethod.offset:n.factorMethod.offset=void 0,"power"in t.factorMethod&&"number"==typeof t.factorMethod.power?n.factorMethod.power=t.factorMethod.power:n.factorMethod.power=void 0):(n.factorMethod.name=void 0,n.factorMethod.scale=void 0,n.factorMethod.offset=void 0,n.factorMethod.power=void 0)),n.displacementMethod={},"displacementMethod"in t&&("string"==typeof t.displacementMethod&&t.displacementMethod in e.calculateAvoidanceDisplacement.builtinMethods?(n.displacementMethod.name=t.displacementMethod,n.displacementMethod.thresholdRadius=void 0):"object"===o(t.displacementMethod)?("name"in t.displacementMethod&&"string"==typeof t.displacementMethod.name&&t.displacementMethod.name in e.calculateAvoidanceDisplacement.builtinMethods?n.displacementMethod.name=t.displacementMethod.name:n.displacementMethod.name=void 0,"thresholdRadius"in t.displacementMethod&&"number"==typeof t.displacementMethod.thresholdRadius?n.displacementMethod.thresholdRadius=t.displacementMethod.thresholdRadius:n.displacementMethod.thresholdRadius=void 0):(n.displacementMethod.name=void 0,n.displacementMethod.thresholdRadius=void 0)),n}},{key:"addParticles",value:function(e){document.querySelectorAll(e).forEach(this.startTrackingParticleElement,this)}},{key:"addParticleElement",value:function(e){this.startTrackingParticleElement(e)}},{key:"removeParticles",value:function(e){this.stopTrackingParticleElements(document.querySelectorAll(e))}},{key:"removeParticleElement",value:function(e){this.stopTrackingParticleElement(e)}},{key:"startTrackingParticleElement",value:function(t){if(!this.trackedParticleElementsSet.has(t)){var n=new e.Particle(t);this.trackedParticles.push(n),this.trackedParticleElementsSet.add(t)}}},{key:"stopTrackingParticleElement",value:function(e){if(this.trackedParticleElementsSet.has(e)){this.trackedParticleElementsSet.delete(e);var t=this.trackedParticles.findIndex((function(t){return t.element===e}));-1!==t&&(this.trackedParticles[t].dispose(),this.trackedParticles.splice(t,1))}}},{key:"stopTrackingParticleElements",value:function(e){for(var t=new Set(e),n=0;n<this.trackedParticles.length;++n)t.has(this.trackedParticles[n].element)&&(this.trackedParticleElementsSet.delete(this.trackedParticles[n].element),this.trackedParticles[n].dispose(),this.trackedParticles[n]="removed");this.trackedParticles=this.trackedParticles.filter((function(e){return"removed"!==e}))}},{key:"start",value:function(){this.containers.forEach(this.registerEventHandlers,this),this.status="running"}},{key:"stop",value:function(){this.containers.forEach(this.deregisterEventHandlers,this),this.status="stopped"}},{key:"addContainers",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=document.querySelectorAll(e);n.forEach((function(e){if(!(this.containers.indexOf(e)>=0)){if(this.containers.push(e),t)for(var n=0;n<e.children.length;++n)this.startTrackingParticleElement(e.children[n]);"running"===this.status&&this.registerEventHandlers(e)}}),this)}},{key:"removeContainers",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=document.querySelectorAll(e);n.forEach((function(e){var n=this.containers.indexOf(e);n<0||(t&&this.stopTrackingParticleElements(e.children),"running"===this.status&&this.deregisterEventHandlers(e),this.containers.splice(n,1))}),this)}},{key:"registerEventHandlers",value:function(e){e.addEventListener("mousemove",this.mouseMoveHandler),e.addEventListener("click",this.mouseClickTestHandler)}},{key:"deregisterEventHandlers",value:function(e){e.removeEventListener("click",this.mouseClickTestHandler),e.removeEventListener("mousemove",this.mouseMoveHandler)}},{key:"mouseMoveHandler",value:function(t){var n=t.currentTarget,o=e.geometry.getRadius({x:n.offsetWidth,y:n.offsetHeight}),i=t.pageX-n.offsetLeft,r=t.pageY-n.offsetTop;this.trackedParticles.forEach((function(t){var n={width:t.element.offsetWidth,height:t.element.offsetHeight},a={x:t.originalPos.x+1*n.width/2-i,y:t.originalPos.y+1*n.height/2-r},c=e.geometry.getRadius(a),s=this.calculateAvoidanceFactor(c,n,o);if(NaN===s)t.element.style.display="none";else{var l=this.calculateAvoidanceDisplacement(a,s),d={x:t.originalPos.x+l.x,y:t.originalPos.y+l.y};"none"===t.element.style.display&&(t.element.style.display=""),t.element.style.left=d.x,t.element.style.top=d.y}}),this)}},{key:"mouseClickTestHandler",value:function(e){var t=this.trackedParticles.map((function(e,t){var n="",o=e.element.getAttribute("id");return n+="particle ".concat(null!==o?o:t,"\n"),n+="original x = ".concat(e.originalPos.x,"\n"),n+="original y = ".concat(e.originalPos.y,"\n"),n+="-------------------\n"})).join("");alert(t)}},{key:"calculateAvoidanceFactor",value:function(t,n,o,i){void 0===i&&(i=this.options.factorMethod.name);return(void 0!==i?e.calculateAvoidanceFactor.builtinMethods[i]:e.calculateAvoidanceFactor.builtinMethods.power_inverse)(this.options.factorMethod.scale,this.options.factorMethod.offset,this.options.factorMethod.power)(t,n,o)}},{key:"calculateAvoidanceDisplacement",value:function(t,n,o){void 0===o&&(o=this.options.displacementMethod.name);return(void 0!==o?e.calculateAvoidanceDisplacement.builtinMethods[o]:e.calculateAvoidanceDisplacement.builtinMethods.absolute_threshold)(this.options.displacementMethod.thresholdRadius)(t,n)}}]),e}();c.geometry={getDistance:function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},getRadius:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)}},c.calculateAvoidanceFactor={builtinMethods:{inverse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(n,o,i){return 0===n?NaN:i*e*1/n+t}},exponential:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25;return function(n,o,i){return Math.exp(e-1*n/i)+t}},power_inverse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.6;return function(o,i,r){return 0===o?NaN:r*e*1/Math.pow(1*o,n)+t}}}},c.calculateAvoidanceDisplacement={builtinMethods:{absolute_threshold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:80;return function(t,n){var o={x:t.x*n,y:t.y*n};if(c.geometry.getRadius(o)>e){var i=c.geometry.getRadius(t),r=e/i;return{x:t.x*r,y:t.y*r}}return o}},proportional_threshold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return function(t,n){var o={x:t.x*n,y:t.y*n};return n>e?{x:t.x*e,y:t.y*e}:o}},standard:function(){return function(e,t){return{x:e.x*t,y:e.y*t}}}}},c.dom={pageOffset:function(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{x:t.left+n,y:t.top+o}},getCentre:function(e,t){return{x:e.offsetLeft+e.offsetWidth/2-(t?t.offsetLeft:0),y:e.offsetTop+e.offsetHeight/2-(t?t.offsetTop:0)}}},c.Particle=function(){function e(t){i(this,e),this.element=t,this.originalPos={x:t.offsetLeft,y:t.offsetTop}}return a(e,[{key:"dispose",value:function(){}}]),e}()}]).default}));
//# sourceMappingURL=avoidance.amd.min.js.map